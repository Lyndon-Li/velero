Add the implementation for design #6950, configurable data path concurrency